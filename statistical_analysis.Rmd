---
title: "stats_analysis"
author: "Qetsiyah Wang"
date: "12/2/2020"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE,
                      fig.height = 6, fig.width = 8)

library(tidyverse)
library(dplyr)
library(DescTools)
library(plotly)
```

  This RMD file mainly focuses on statistical analysis for internal indicators: participants' consumption frequence on fast food and exercise frequency, and their interactions with bmi that would be used as the parameter for eating health. The whole part will be divided as three portions: scatter plots of two indicators vs. erbmi, multiple regression model between two indicators and bmi, and analysis adjustment if needed.
  
  
## Tidy Dataset for internal indicators
```{r}

internal_indicators = raw_eathealth %>%
  select(erbmi, eufastfdfrq, euexfreq) %>%
  filter_all(all_vars(. > 0))

```

## Scatter plots of BMI vs. Frequency of Fast Food Consumption and Exercise

  


```{r}

round(cor(internal_indicators), 3)

mlr_model = lm(erbmi ~ eufastfdfrq + euexfreq, data = internal_indicators)
summary(mlr_model)

par(mfrow = c(2, 2))
plot(mlr_model)

```


```{r}

adjust_model = internal_indicators %>%
  mutate(
    rstand = rstandard(mlr_model)
  )  %>%
  filter(abs(rstand) < 2.5)

mlr_adjust = lm(erbmi ~ eufastfdfrq + euexfreq, data = adjust_model)
summary(mlr_adjust)

par(mfrow = c(2,2))
plot(mlr_adjust)


```



